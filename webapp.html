

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Web アプリ 導入編 &mdash; Python School 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="Python School 1.0.0 documentation" href="index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>Python School 1.0.0 documentation</span></a></h1>
        <h2 class="heading"><span>Web アプリ 導入編</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="web">
<h1>Web アプリ 導入編<a class="headerlink" href="#web" title="Permalink to this headline">¶</a></h1>
<p>Django で Web アプリを作成します。</p>
<div class="section" id="id1">
<h2>プロジェクトの作成と設定<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p><strong class="command">virtualenv</strong> を使って専用環境を作成します。</p>
<div class="highlight-python"><pre>&gt; D:
&gt; cd D:\sandbox
&gt; C:\Python27\Scripts\virtualenv.exe --distribute django-sample</pre>
</div>
<p><cite>django-sample</cite> フォルダに <tt class="file docutils literal"><span class="pre">requirements.txt</span></tt> を作成し、 <strong class="command">pip</strong> で読み込ませます。</p>
<div class="highlight-python"><pre>&gt; cd django-sample
&gt; notepad requirements.txt        # 下記参照
&gt; Scripts\activate
&gt; pip install -r requirements.txt</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><tt class="file docutils literal"><span class="pre">requirements.txt</span></tt></p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">Django</span><span class="o">==</span><span class="mf">1.3</span>
</pre></div>
</div>
</div>
<p><tt class="file docutils literal"><span class="pre">django-admin.py</span></tt> というスクリプトが追加されます。
これを使ってカテゴリーテンプレートを管理するプロジェクト <cite>cateditor</cite> を作成します。</p>
<div class="highlight-python"><pre>&gt; python Scripts\django-admin.py startproject cateditor</pre>
</div>
<p>cateditor の <tt class="file docutils literal"><span class="pre">settings.py</span></tt> を編集します。</p>
<div class="highlight-python"><pre>&gt; cd cateditor
&gt; notepad settings.py        # 下記参照</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>データベースには SQLite を使いますので、 DATABASES の部分を次のように変更します。</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;django.db.backends.sqlite3&#39;</span><span class="p">,</span>
        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&#39;cateditor.sqlite&#39;</span><span class="p">,</span>
        <span class="s">&#39;USER&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="s">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="s">&#39;HOST&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="s">&#39;PORT&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Django の管理ツール <tt class="file docutils literal"><span class="pre">manage.py</span></tt> を使ってデータベースを作成します。</p>
<div class="highlight-python"><pre>&gt; python manage.py syncdb</pre>
</div>
<p>次の質問には &#8220;yes&#8221; と答え、ユーザー名、メールアドレス、パスワードをそれぞれ入力します。</p>
<blockquote>
<div>Would you like to create one now? (yes/no): yes</div></blockquote>
<p>フォルダには先ほど指定したデータベースファイル <tt class="file docutils literal"><span class="pre">cateditor.sqlite</span></tt> が作成されています。</p>
<div class="highlight-python"><pre>&gt; dir /b
cateditor.sqlite
manage.py
settings.py
settings.pyc
urls.py
__init__.py
__init__.pyc</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>カテゴリーテンプレートとは？</p>
<p class="last">海外LBSに必要なものです。管理が大変なので、管理用アプリケーションを誰か作ってください m(_ _)m</p>
</div>
</div>
<div class="section" id="id2">
<h2>管理画面の有効化<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Django には管理画面がアプリケーションとして同梱されていますので、それを有効化します。
<tt class="file docutils literal"><span class="pre">settings.py</span></tt> と <tt class="file docutils literal"><span class="pre">urls.py</span></tt> を編集します。</p>
<p><tt class="file docutils literal"><span class="pre">settings.py</span></tt> の下の方にある INSTALLED_APPS で <tt class="docutils literal"><span class="pre">django.contrib.admin</span></tt>  をコメントインします。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.sites&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="s">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="c"># Uncomment the next line to enable admin documentation:</span>
    <span class="c"># &#39;django.contrib.admindocs&#39;,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><tt class="file docutils literal"><span class="pre">urls.py</span></tt> を変更します。英語ですが、コメントを読んでください。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls.defaults</span> <span class="kn">import</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>

<span class="c"># Uncomment the next two lines to enable the admin:</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="n">admin</span><span class="o">.</span><span class="n">autodiscover</span><span class="p">()</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span>
    <span class="c"># Examples:</span>
    <span class="c"># url(r&#39;^$&#39;, &#39;cateditor.views.home&#39;, name=&#39;home&#39;),</span>
    <span class="c"># url(r&#39;^cateditor/&#39;, include(&#39;cateditor.foo.urls&#39;)),</span>

    <span class="c"># Uncomment the admin/doc line below to enable admin documentation:</span>
    <span class="c"># url(r&#39;^admin/doc/&#39;, include(&#39;django.contrib.admindocs.urls&#39;)),</span>

    <span class="c"># Uncomment the next line to enable the admin:</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2>テストサーバの起動<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Django の管理ツール <tt class="file docutils literal"><span class="pre">manage.py</span></tt> を使ってテストサーバを起動します。</p>
<div class="highlight-python"><pre>&gt; python manage.py runserver</pre>
</div>
<p>Web ブラウザで 8000 番ポートの <cite>/admin</cite> にアクセスすると管理画面が表示されます。</p>
<ul class="simple">
<li><a class="reference external" href="http://localhost:8000/admin/">http://localhost:8000/admin/</a></li>
</ul>
<p>ユーザー名とパスワードは、上述の syncdb のときに入力したものです。</p>
<p>Ctrl+C でテストサーバを停止できます。</p>
</div>
<div class="section" id="id4">
<h2>次は？<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Django には豊富なドキュメントが用意されています。
チュートリアルを読みながら一通り手を動かしてみてください。</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.djangoproject.com/en/dev/intro/tutorial01/">Django チュートリアル</a></li>
<li><a class="reference external" href="http://djangoproject.jp/doc/ja/1.0/">Django チュートリアル 日本語</a> (バージョン 1.0 なのでちょっと古い)</li>
</ul>
<ul class="simple">
<li><a class="reference external" href="http://blog.mozilla.com/webdev/2011/10/20/open-sourcing-your-django-site/">Open sourcing your Django site</a></li>
</ul>
</div>
<div class="section" id="id6">
<h2>アプリケーションの作成<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>アプリケーションを作成します。</p>
<div class="highlight-python"><pre>&gt; python manage.py startapp cateditor</pre>
</div>
<p>Django においてプロジェクトとアプリケーションを異なります。
詳しくは公式ドキュメントを参照してください。</p>
<p>アプリケーションは <tt class="file docutils literal"><span class="pre">settings.py</span></tt> に登録します。</p>
<div class="section" id="id7">
<h3>モデルの定義<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>アプリケーションの <tt class="file docutils literal"><span class="pre">models.py</span></tt> を編集します。</p>
<p>変更が終わったら syncdb を実行し、管理画面を確認しましょう。</p>
<ul class="simple">
<li><a class="reference external" href="http://pinaxproject.com/">Pinax</a></li>
<li><a class="reference external" href="https://github.com/dotcloud/geodjango-on-dotcloud">GeoDjango</a></li>
</ul>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, KITAZAKI Shigeru.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>